<!doctype html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-spring4-4.dtd">
<html lang="en" xmlns:th="http://www.thymeleaf.org">
    <th:block th:include="_head"></th:block>
<body>

    <th:block sec:authorize="isAuthenticated()">
        <a href="/">Main Page</a>
        <div th:each="template : ${templatesList}" class="templatesList" th:id="${template.getId()}">
            Template id: <span th:text="${template.getId()}"></span><br />
            Template name: <span th:text="${template.getTemplateName()}"></span><br />
            Template enabled?: <span th:text="${template.isTemplateEnabled()}"></span><br /><br />
        </div>

        <div class='newTemplate' style="display: none">
            Template Name: <input/> <button class='sendNewTemplate' type='button'>Add</button>
        </div>
        <button class="newTemplateButton" type="button">New template</button>
    </th:block>


<script th:inline="javascript">
    templates = /*[[${templatesList}]]*/ "";
    spends = /*[[${spends}]]*/ "";

    $( document ).ready(function() {

        $('.templatesList').click(function (x) {
            x.preventDefault();
            var templateListId = $(this).attr('id');
            getTemplates(templateListId, function(callback){
                $('.templatesList').hide();
                $('button').hide();
                appendTemplates(callback, templateListId);
            });
        });

        $('.newTemplateButton').click(function () {
            $(this).toggle();
            $('.newTemplate').toggle();
        });

        $('.sendNewTemplate').click(function () {
            var name = $(this).parent().find('input').val();
            $.ajax({
                type : "POST",
                url : "/templatesList/addTemplatesListWithName?name=" + name,
                success: function(){
                    alert('success!')
                }
            });
        });

    });
</script>
</body>
</html>
